--- a/Modules/Setup
+++ a/Modules/Setup
@@ -387,7 +387,7 @@
 _lzma _lzmamodule.c -I$(prefix)/include -L$(prefix)/lib -llzma
 
 # scproxy module only for osx
-$(OSX_SCPROXY)
+_scproxy $(srcdir)/Modules/_scproxy.c -framework SystemConfiguration -framework CoreFoundation
 
 # Uncommenting the following line tells makesetup that all following modules
 # are not built (see above for more detail).
